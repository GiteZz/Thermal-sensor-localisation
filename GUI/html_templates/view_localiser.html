{% extends "main.html" %}

{% block content %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/debug_tracker.css')}}">
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
<meta charset="UTF-8">
<script>
    $(document).ready(function(){
        var current_objects = {};  //dict: <key:(x,y)>
        var colors={}; //color per object in a dict
        var socket = io.connect('http://'+ document.domain+':'+location.port);
        var img = document.getElementById("dot_page");
        var legend = document.getElementById("id_list");

        var dots = [];
        var legend_items = [];

        socket.on('connect', function(){
            console.log('Im Connected');
           });

        socket.on('localiser_update', function(data){
            console.log("update received");
            console.log(data);


            img.innerHTML = '';

            legend.innerHTML = '';

            for(i = 0; i < data.length; i++){
                person_loc = data[i];
                var dot = document.createElement("div");
                dot.className = "dot";
                dot.style.top = String(parseInt(person_loc[0])-10) + "px";
                dot.style.left = String(parseInt(person_loc[1])-10) + "px";
                dot.style.backgroundColor = "#000000";
                img.appendChild(dot);
            }
        });

    });

    function intToRGB(i) {
    var hex = (((i*30)<<2)&0xFF).toString(16) +
            (((i*15417))&0xFF).toString(16) +
            (((i*127)>>8)&0xFF).toString(16) +
            ((i*19)&0xFF).toString(16);
    // Sometimes the string returned will be too short so we 
    // add zeros to pad it out, which later get removed if
    // the length is greater than six.
    hex += '000000';
    return hex.substring(0, 6);
}
</script>
<h1>Localisation output</h1>
<div class="main_wrapper">
    <div class="debug_img" id="img">
        <img src="../static/Img/layout.png" alt="" >
        <div id="dot_page" style="height: 100%; width: 100%; left: 0;top: 0; position: absolute;">

        </div>
    </div>
    <div class="legend" id="legend">
        <h3>Objects</h3>
        <div id="id_list" style="display: grid;">

        </div>
    </div>
</div>
{% endblock %}